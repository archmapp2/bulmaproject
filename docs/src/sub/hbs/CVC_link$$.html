<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Bulma Handlebars" />
    <title>Bulma Project [Web Components]</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma-extensions@6.2.7/dist/css/bulma-extensions.min.css"
    />

    <script
      defer
      src="https://use.fontawesome.com/releases/v5.7.1/js/all.js"
    ></script>

    <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>

    <!-- ファビコンは、distフォルダをルートにした時現れる！ -->
    <link
      rel="icon"
      type="image/png"
      href="../../assets/img/favicon-c2.png"
      sizes="16x16"
    />

    <script src="../../js/shortBulma$$.js"></script>
    <!-- <script src="../../js/shortHbs$$.js"></script> -->

    <!-- <script src="../../sub/hbs/main_link.js" defer></script> -->

    <style></style>
  </head>

  <body>
    <nav
      class="navbar is-primary has-text-weight-medium has-shadow"
      role="navigation"
      aria-label="Main navigation"
      id="nav"
    >
      <div class="container">
        <div class="navbar-brand">
          <a href="../../../index.html" class="navbar-item" title="Top page"
            >BulmaProject</a
          >
          <div id="burger" class="navbar-burger" data-target="navbarMenu">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>

        <div class="navbar-menu is-primary is-pulled-right mr-2" id="nav-links">
          <div class="navbar-start navbar-item">
            <a
              href="https://bulma.io/documentation/"
              target="_blank"
              rel="noopener noreferrer"
              class="button navbar-item is-primary is-fullwidth mt-1"
              title="Bulma home!!"
            >
              <span class="icon">
                <img src="../../assets/img/bulma32.ico" alt="bulma" />
              </span>
              <span>Bulma</span>
            </a>
          </div>

          <div class="navbar-end has-text-dark">
            <a href="../../sub/js/js.html" class="navbar-item has-text-right"
              >Javascript</a
            >
            <a href="../../sub/hbs/hbs.html" class="navbar-item has-text-right"
              >Handlebars</a
            >
            <a href="../../sub/tron/tron.html" class="navbar-item has-text-right"
              >Electron</a
            >
            <a href="../../sub/ang/ang.html" class="navbar-item has-text-right"
              >Angular</a
            >
            <a href="../../sub/react/react.html" class="navbar-item has-text-right"
              >React</a
            >
          </div>
        </div>
      </div>
    </nav>

    <section class="section">
      <div class="container">
        <div class="notification has-background-primary-light is-bold mb-1">
          <div class="container">
            <h1 class="title">Handlebars</h1>
            <h2 class="subtitle is-5">Handlebars & Web Components</h2>
          </div>
        </div>

        <!-- breadcrumbs -->
        <div class="section pt-0 pb-0">
          <nav class="breadcrumb has-arrow-separator">
            <ul class="is-size-6 container">
              <li>
                <a href="/" class="has-text-grey-light">Top page</a>
              </li>
              <li>
                <a href="../../sub/hbs/hbs.html" class="has-text-grey-light"
                  >Handlebars</a
                >
              </li>
              <li class="is-active"><a href="#">CVC_link</a></li>
            </ul>
          </nav>
        </div>

        <div class="columns">
          <div class="column"></div>
          <div class="column is-10 mt-4">
            <article class="message is-primary py-1">
              <div class="message-header subtitle">
                <p>ポップアップ情報 widget - web components</p>
              </div>
              <div class="message-body has-text-centered is-size-5 pt-1">
                参考URL：<br />
                <span class="is-size-6 ml-3"
                  >&nbsp;https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM
                </span>
                <p class="is-size-6 has-text-dark">
                  　引き続き
                  <strong>Web Component</strong>
                  で、カスタムタグ<strong>&lt;popup-info</strong>>の作成
                </p>
              </div>
            </article>

            <main>
              <div class="columns is-centered mt-5 has-background-white-bis">
                <div class="column is-8 py-6">
                  <div class="box">
                    <main>
                      <form>
                        <div class="field">
                          <label class="label"
                            >CVC の入力
                            <popup-info
                              img="alt.png"
                              data-text="Your card validation code (CVC) is an extra security feature — it is the last 3 or 4 numbers on the back of your card."
                            ></popup-info>
                          </label>
                          <div class="control has-icons-left">
                            <input
                              class="input"
                              id="cvc"
                              type="text"
                              placeholder="numbers input"
                            />
                            <span class="icon is-small is-left">
                              <i class="fas fa-user"></i>
                            </span>
                          </div>
                        </div>

                        <div class="field">
                          <label class="label"
                            >CVC の入力
                            <popup-info
                              img="alt_danger.png"
                              data-text="Your card validation code (CVC) is an extra security feature — it is the last 3 or 4 numbers on the back of your card."
                            ></popup-info>
                          </label>
                          <div class="control has-icons-left">
                            <input
                              class="input"
                              id="cvc2"
                              type="text"
                              placeholder="numbers input"
                            />
                            <span class="icon is-small is-left">
                              <i class="fas fa-user"></i>
                            </span>
                          </div>
                        </div>

                        <div class="field">
                          <label class="label"
                            >CVC の入力
                            <popup-info
                              img="alt_success.png"
                              data-text="Your card validation code (CVC) is an extra security feature — it is the last 3 or 4 numbers on the back of your card."
                            ></popup-info>
                          </label>
                          <div class="control has-icons-left">
                            <input
                              class="input"
                              id="cvc3"
                              type="text"
                              placeholder="numbers input"
                            />
                            <span class="icon is-small is-left">
                              <i class="fas fa-user"></i>
                            </span>
                          </div>
                        </div>
                      </form>
                    </main>
                  </div>
                </div>
              </div>
              <hr />
            </main>

            <div class="box">
              <h2 class="subtitle has-background-white-ter mb-2 p-2">
                上記のソースコード
              </h2>

              <blockquote class="is-size-6 ml-2">
                <pre id="pre1">
&lt;!-- CVC_link.html --&gt;

&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;ja&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;
    &lt;meta name=&quot;description&quot; content=&quot;Bulma Handlebars&quot; /&gt;
    &lt;title&gt;Bulma Project [Web Components]&lt;/title&gt;
    &lt;link
      rel=&quot;stylesheet&quot;
      href=&quot;https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css&quot;
    /&gt;
    &lt;link
      rel=&quot;stylesheet&quot;
      href=&quot;https://cdn.jsdelivr.net/npm/bulma-extensions@6.2.7/dist/css/bulma-extensions.min.css&quot;
    /&gt;

    &lt;script
      defer
      src=&quot;https://use.fontawesome.com/releases/v5.7.1/js/all.js&quot;
    &gt;&lt;/script&gt;

    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js&quot;&gt;&lt;/script&gt;

    &lt;script src=&quot;/src/js/shortBulma$$.js&quot;&gt;&lt;/script&gt;
    &lt;!-- &lt;script src=&quot;/src/js/shortHbs$$.js&quot;&gt;&lt;/script&gt; --&gt;

    &lt;!-- &lt;script src=&quot;main_link.js&quot; defer&gt;&lt;/script&gt; --&gt;

    &lt;style&gt;&lt;/style&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;section class=&quot;section&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;columns&quot;&gt;
          &lt;div class=&quot;column&quot;&gt;&lt;/div&gt;
          &lt;div class=&quot;column is-10 mt-4&quot;&gt;
            &lt;article class=&quot;message is-primary pb-3&quot;&gt;
              &lt;div class=&quot;message-header subtitle&quot;&gt;
                &lt;p&gt;ポップアップ情報 widget - web components&lt;/p&gt;
              &lt;/div&gt;
              &lt;div class=&quot;message-body has-text-centered is-size-5&quot;&gt;
                &lt;span class=&quot;is-size-5&quot;
                  &gt;参考URL：&lt;br&gt;https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM&lt;/span
                &gt;
              &lt;/div&gt;
            &lt;/article&gt;

            &lt;div class=&quot;columns is-centered mt-5 has-background-white-bis&quot;&gt;
              &lt;div class=&quot;column is-8 py-6&quot;&gt;
                &lt;div class=&quot;box&quot;&gt;
                  &lt;main&gt;
                    &lt;form&gt;
                      &lt;div class=&quot;field&quot;&gt;
                        &lt;label class=&quot;label&quot;
                          &gt;CVC の入力
                          &lt;popup-info
                            img=&quot;alt.png&quot;
                            data-text=&quot;Your card validation code (CVC) is an extra security feature — it is the last 3 or 4 numbers on the back of your card.&quot;
                          &gt;&lt;/popup-info&gt;
                        &lt;/label&gt;
                        &lt;div class=&quot;control has-icons-left&quot;&gt;
                          &lt;input
                            class=&quot;input&quot;
                            id=&quot;cvc&quot;
                            type=&quot;text&quot;
                            placeholder=&quot;numbers input&quot;
                          /&gt;
                          &lt;span class=&quot;icon is-small is-left&quot;&gt;
                            &lt;i class=&quot;fas fa-user&quot;&gt;&lt;/i&gt;
                          &lt;/span&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;

                      &lt;div class=&quot;field&quot;&gt;
                        &lt;label class=&quot;label&quot;
                          &gt;CVC の入力
                          &lt;popup-info
                            img=&quot;alt_danger.png&quot;
                            data-text=&quot;Your card validation code (CVC) is an extra security feature — it is the last 3 or 4 numbers on the back of your card.&quot;
                          &gt;&lt;/popup-info&gt;
                        &lt;/label&gt;
                        &lt;div class=&quot;control has-icons-left&quot;&gt;
                          &lt;input
                            class=&quot;input&quot;
                            id=&quot;cvc2&quot;
                            type=&quot;text&quot;
                            placeholder=&quot;numbers input&quot;
                          /&gt;
                          &lt;span class=&quot;icon is-small is-left&quot;&gt;
                            &lt;i class=&quot;fas fa-user&quot;&gt;&lt;/i&gt;
                          &lt;/span&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;

                      &lt;div class=&quot;field&quot;&gt;
                        &lt;label class=&quot;label&quot;
                          &gt;CVC の入力
                          &lt;popup-info
                            img=&quot;alt_success.png&quot;
                            data-text=&quot;Your card validation code (CVC) is an extra security feature — it is the last 3 or 4 numbers on the back of your card.&quot;
                          &gt;&lt;/popup-info&gt;
                        &lt;/label&gt;
                        &lt;div class=&quot;control has-icons-left&quot;&gt;
                          &lt;input
                            class=&quot;input&quot;
                            id=&quot;cvc3&quot;
                            type=&quot;text&quot;
                            placeholder=&quot;numbers input&quot;
                          /&gt;
                          &lt;span class=&quot;icon is-small is-left&quot;&gt;
                            &lt;i class=&quot;fas fa-user&quot;&gt;&lt;/i&gt;
                          &lt;/span&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                    &lt;/form&gt;
                  &lt;/main&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;

            &lt;div class=&quot;box mt-2&quot;&gt;
              &lt;div class=&quot;box&quot;&gt;
                &lt;h2 class=&quot;is-size-4 has-background-white-ter p-2 km&quot;&gt;
                  　解説
                &lt;/h2&gt;
                &lt;div class=&quot;content&quot;&gt;
                  &lt;ul&gt;
                    &lt;li class=&quot;pt-1&quot;&gt;
                      &lt;dl&gt;
                        &lt;dt&gt;
                          &lt;strong
                            &gt;$$oa_t(this.shadowRoot, &#039;twoot-post&#039;);&lt;/strong
                          &gt;
                        &lt;/dt&gt;
                        &lt;dd class=&quot;py-2&quot;&gt;
                          テンプレート#templateをコンパイルし、コンテキストｖを適用して得られたHTMLコードを、要素#contentsのinnserHTMLプロパティに代入する。
                        &lt;/dd&gt;
                        &lt;dt&gt;
                          &lt;strong&gt;$$oq(this.shadowRoot, &#039;img&#039;)&lt;/strong&gt;
                        &lt;/dt&gt;
                        &lt;dd class=&quot;py-2&quot;&gt;
                          オブジェクトthis.shadowRootから&#039;img&#039;要素を求める。
                        &lt;/dd&gt;
                        &lt;dt&gt;
                          &lt;strong&gt;$$oe = (o, f, evNa = &#039;click&#039;) &lt;/strong&gt;
                        &lt;/dt&gt;
                        &lt;dd class=&quot;py-2&quot;&gt;
                          オブジェクトthis.shadowRootに、clickイベントリスナーf
                          を登録する。
                        &lt;/dd&gt;
                        &lt;dt&gt;
                          &lt;strong
                            &gt;$$ocL(this.options, &#039;hidden&#039;, &#039;remove&#039;);&lt;/strong
                          &gt;
                        &lt;/dt&gt;
                        &lt;dd class=&quot;py-2&quot;&gt;
                          オブジェクトから&#039;hidden&#039;クラスを取り除く。
                        &lt;/dd&gt;
                      &lt;/dl&gt;
                    &lt;/li&gt;
                  &lt;/ul&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;

          &lt;div class=&quot;column&quot;&gt;&lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/section&gt;

    &lt;script&gt;
      class PopUpInfo extends HTMLElement {
        constructor() {
          super();

          // Create a shadow root
          const shadow = this.attachShadow({ mode: &#039;open&#039; });

          const wrapper = document.createElement(&#039;span&#039;);
          wrapper.setAttribute(&#039;class&#039;, &#039;wrapper&#039;);

          const icon = document.createElement(&#039;span&#039;);
          icon.setAttribute(&#039;class&#039;, &#039;icon&#039;);
          icon.setAttribute(&#039;tabindex&#039;, 0); // Tabキーによるフォーカスの移動順序を指定する属性

          let imgUrl;
          if (this.hasAttribute(&#039;img&#039;)) {
            imgUrl = this.getAttribute(&#039;img&#039;);
          } else {
            imgUrl = &#039;default.png&#039;;
          }

          const img = document.createElement(&#039;img&#039;);
          img.src = `./img/${imgUrl}`;
          // img.src = `/src/assets/img/${imgUrl}`;
          icon.appendChild(img);

          const info = document.createElement(&#039;span&#039;);
          info.setAttribute(&#039;class&#039;, &#039;info&#039;);

          const text = this.getAttribute(&#039;data-text&#039;);
          info.textContent = text;

          switch (imgUrl) {
            case &#039;alt.png&#039;:
              info.style.backgroundColor = &#039;#67cebf&#039;;
              break;
            case &#039;alt_danger.png&#039;:
              info.style.backgroundColor = &#039;#fee&#039;;
              break;
            case &#039;alt_success.png&#039;:
              info.style.backgroundColor = &#039;#efb&#039;;
              break;
            default:
              info.style.backgroundColor = &#039;white&#039;;
          }

          wrapper.appendChild(icon);
          wrapper.appendChild(info);

          // Apply external styles to the shadow dom
          const styleElm = document.createElement(&#039;style&#039;);
          styleElm.innerHTML = `
            .wrapper {
              position: relative;
            }

            .info {
              font-size: 0.8rem;
              width: 200px;
              display: inline-block;
              border: 1px solid black;
              padding: 10px;
              // background:   #fee;
              // background:  #efb;
              // background:  #67cebf;
              border-radius: 10px;
              opacity: 0;
              transition: 0.6s all;
              position: absolute;
              bottom: 20px;
              left: 10px;
              z-index: 3;
            }

            img {
              width: 1.2rem;
            }

            .icon:hover + .info,
            .icon:focus + .info {
              opacity: 0.9;
            }
            `;

          // Attach the created elements to the shadow dom
          shadow.appendChild(styleElm);
          shadow.appendChild(wrapper);
        }
      }

      // Define the new element
      customElements.define(&#039;popup-info&#039;, PopUpInfo);
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre
                >
              </blockquote>

              <div class="box mt-2">
                <h2 class="is-size-4 has-background-white-ter p-2 km">
                  　解説
                </h2>
                <div class="content">
                  <ul>
                    <li>
                      BulmaでJavascriptを利用するために、このWebサイトでは<br />
                      　<a href="../../sub/js/shortBulma.html"
                        ><strong>shortBulma$$.js</strong> または
                        <strong>shortBulma.js</strong></a
                      ><br />
                      というライブラリを使います。
                    </li>
                    <li class="pt-2">
                      使い方の例：&lt;script
                      src=&quot;/src/js/shortBulma$$.js&quot;&gt;&lt;/script&gt;<br />
                      headタグ内に挿入。但し、pathは状況によって変わります。
                    </li>
                    <li class="pt-2">
                      <p class="pt-3 px-3">
                        例えば、notification$$.htmlとshortBulma$$.jsが同じフォルダにある時は<br />
                        &lt;script
                        src=&quot;./shortBulma$$.js&quot;&gt;&lt;/script&gt;
                        または<br />
                        &lt;script
                        src=&quot;shortBulma$$.js&quot;&gt;&lt;/script&gt;
                        となります。
                      </p>
                    </li>
                    <hr />
                    <dt>$$bulmaMenu('#burger', '#nav-links');</dt>
                    <dd class="py-2">
                      狭い画面で表示されるBulmaのburgerメニューをコントロールします。<br />burgerアイコンとbodyにそれぞれイベントを設定して、
                      <ul>
                        <li>
                          [burgerアイコン]のクリックでburgerメニューを開閉
                        </li>
                        <li>[body]のクリックでburgerメニューを閉じます。</li>
                      </ul>
                    </dd>
                    <dt>$$codeS('#pre1')</dt>
                    <dd class="py-2">
                      コードの全コピーを準備するため、コードをクリックしたときにそれを選択状態にします。
                    </dd>
                    <hr />
                    <dt>
                      ［ポップアップ情報］<br />
                      利用させていただいたのは、<strong>MDN</strong>のUsing
                      shadow DOMです。
                    </dt>
                    <dd class="py-2">
                      <a
                        href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM"
                        >Using shadow DOM</a
                      >
                    </dd>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div class="column"></div>
        </div>

        <!-- breadcrumbs -->
        <div class="section pt-0 pb-0">
          <nav class="breadcrumb has-arrow-separator">
            <ul class="is-size-6 container">
              <li>
                <a href="/" class="has-text-grey-light">Top page</a>
              </li>
              <li>
                <a href="../../sub/hbs/hbs.html" class="has-text-grey">Handlebars</a>
              </li>
              <li class="is-active"><a href="#">CVC_link</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </section>

    <script>
      $$bulmaMenu('#burger', '#nav-links');
      $$codeS('#pre1');
    </script>

    <script>
      class PopUpInfo extends HTMLElement {
        constructor() {
          super();

          const shadow = this.attachShadow({ mode: 'open' });

          const wrapper = document.createElement('span');
          wrapper.setAttribute('class', 'wrapper');

          const icon = document.createElement('span');
          icon.setAttribute('class', 'icon');
          icon.setAttribute('tabindex', 0); // Tabキーによるフォーカスの移動順序を指定する属性

          let imgUrl;
          if (this.hasAttribute('img')) {
            imgUrl = this.getAttribute('img');
          } else {
            imgUrl = 'default.png';
          }

          const img = document.createElement('img');
          // img.src = `./img/${imgUrl}`;
          // img.src = `/src/assets/img/${imgUrl}`;
          img.src = `../../assets/img/${imgUrl}`;
          icon.appendChild(img);

          const info = document.createElement('span');
          info.setAttribute('class', 'info');

          const text = this.getAttribute('data-text');
          info.textContent = text;

          switch (imgUrl) {
            case 'alt.png':
              info.style.backgroundColor = '#67cebf';
              break;
            case 'alt_danger.png':
              info.style.backgroundColor = '#fee';
              break;
            case 'alt_success.png':
              info.style.backgroundColor = '#efb';
              break;
            default:
              info.style.backgroundColor = 'white';
          }

          wrapper.appendChild(icon);
          wrapper.appendChild(info);

          // Apply external styles to the shadow dom
          const linkElem = document.createElement('link');
          linkElem.setAttribute('rel', 'stylesheet');
          linkElem.setAttribute('type', 'text/css');
          // linkElem.setAttribute('href', './style_link.css');
          linkElem.setAttribute('href', '../../sub/hbs/style_link.css');

          // Attach the created elements to the shadow dom
          shadow.appendChild(linkElem);
          shadow.appendChild(wrapper);
        }
      }

      // Define the new element
      customElements.define('popup-info', PopUpInfo);
    </script>
  </body>
</html>
